# Cactus app 
![GitHub last commit](https://img.shields.io/github/last-commit/Krystian19/cactus-app.svg?style=popout-square) ![GitHub](https://img.shields.io/github/license/Krystian19/cactus-app.svg?style=popout-square)

Cactus app is an open source service to stream your favorite anime.

## Services
|  [Client Repo](https://github.com/Krystian19/cactus-app-client-service) | [BFF Repo](https://github.com/Krystian19/cactus-app-bff-service/tree/master) | [Core Repo](https://github.com/Krystian19/cactus-app-core-service/tree/master) |
|:---------------------:|:---------------------:|:---------------------:|
| [![Build Status](https://travis-ci.org/Krystian19/cactus-app-client-service.svg?branch=master)](https://travis-ci.org/Krystian19/cactus-app-client-service) [![Codacy Badge](https://api.codacy.com/project/badge/Grade/166aa4764f6244538723d85594ab60b7)](https://www.codacy.com/app/janfrancisco19/cactus-app-client-service?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Krystian19/cactus-app-client-service&amp;utm_campaign=Badge_Grade) [![Test Coverage](https://codecov.io/gh/Krystian19/cactus-app-client-service/branch/master/graph/badge.svg)](https://codecov.io/gh/Krystian19/cactus-app-client-service) | [![Build Status](https://travis-ci.org/Krystian19/cactus-app-bff-service.svg?branch=master)](https://travis-ci.org/Krystian19/cactus-app-bff-service) [![Codacy Badge](https://api.codacy.com/project/badge/Grade/103013eebdfa4de6a76ac2aa13069982)](https://www.codacy.com/app/janfrancisco19/cactus-app-bff-service?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Krystian19/cactus-app-bff-service&amp;utm_campaign=Badge_Grade) | [![Build Status](https://travis-ci.org/Krystian19/cactus-app-core-service.svg?branch=master)](https://travis-ci.org/Krystian19/cactus-app-core-service) [![Codacy Badge](https://api.codacy.com/project/badge/Grade/5f62f9c87bd7405395824d035a372cbb)](https://www.codacy.com/app/janfrancisco19/cactus-app-core-service?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Krystian19/cactus-app-core-service&amp;utm_campaign=Badge_Grade) |

|  [Admin Repo](https://github.com/Krystian19/cactus-app-admin-service/tree/master) | [Image CDN Repo](https://github.com/Krystian19/cactus-fake-image-cdn-service/tree/master) | [Video CDN Repo](https://github.com/Krystian19/cactus-fake-video-cdn-service/tree/master) |
|:---------------------:|:---------------------:|:---------------------:|
| [![Build Status](https://travis-ci.org/Krystian19/cactus-app-admin-service.svg?branch=master)](https://travis-ci.org/Krystian19/cactus-app-admin-service) [![Codacy Badge](https://api.codacy.com/project/badge/Grade/5f62f9c87bd7405395824d035a372cbb)](https://www.codacy.com/app/janfrancisco19/cactus-app-admin-service?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Krystian19/cactus-app-admin-service&amp;utm_campaign=Badge_Grade) [![Test Coverage](https://codecov.io/gh/Krystian19/cactus-app-admin-service/branch/master/graph/badge.svg)](https://codecov.io/gh/Krystian19/cactus-app-admin-service) | [![Build Status](https://travis-ci.org/Krystian19/cactus-fake-image-cdn-service.svg?branch=master)](https://travis-ci.org/Krystian19/cactus-fake-image-cdn-service) [![Codacy Badge](https://api.codacy.com/project/badge/Grade/f532765d7ee248499c7a3ef4ff1f474c)](https://www.codacy.com/app/janfrancisco19/cactus-fake-image-cdn-service?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Krystian19/cactus-fake-image-cdn-service&amp;utm_campaign=Badge_Grade)  [![Test Coverage](https://codecov.io/gh/Krystian19/cactus-fake-image-cdn-service/branch/master/graph/badge.svg)](https://codecov.io/gh/Krystian19/cactus-fake-image-cdn-service) | [![Build Status](https://travis-ci.org/Krystian19/cactus-fake-video-cdn-service.svg?branch=master)](https://travis-ci.org/Krystian19/cactus-fake-video-cdn-service) [![Codacy Badge](https://api.codacy.com/project/badge/Grade/65bb1660e35a4cc8ad38b0e8ad425c8f)](https://www.codacy.com/app/janfrancisco19/cactus-fake-video-cdn-service?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Krystian19/cactus-fake-video-cdn-service&amp;utm_campaign=Badge_Grade) [![Test Coverage](https://codecov.io/gh/Krystian19/cactus-fake-video-cdn-service/branch/master/graph/badge.svg)](https://codecov.io/gh/Krystian19/cactus-fake-video-cdn-service) |

## Internal Tools & Libraries
|  [GraphQL Schema Module](https://github.com/Krystian19/cactus-app-schema-module/tree/master) | [JS DB module](https://github.com/Krystian19/cactus-app-db-module/tree/master) | [JS Logger module](https://github.com/Krystian19/cactus-app-js-logger-module)
|:---------------------:|:---------------------:|:---------------------:|
| [![Build Status](https://travis-ci.org/Krystian19/cactus-app-schema-module.svg?branch=master)](https://travis-ci.org/Krystian19/cactus-app-schema-module) [![Codacy Badge](https://api.codacy.com/project/badge/Grade/e73cfab590104795ac1b2a7b39eb8136)](https://www.codacy.com/app/janfrancisco19/cactus-app-schema-module?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Krystian19/cactus-app-schema-module&amp;utm_campaign=Badge_Grade) [![Test Coverage](https://codecov.io/gh/Krystian19/cactus-app-schema-module/branch/master/graph/badge.svg)](https://codecov.io/gh/Krystian19/cactus-app-schema-module)      | [![Build Status](https://travis-ci.org/Krystian19/cactus-app-db-module.svg?branch=master)](https://travis-ci.org/Krystian19/cactus-app-db-module) [![Codacy Badge](https://api.codacy.com/project/badge/Grade/5fbaf1e4fe25483fa34819f10c628ffb)](https://www.codacy.com/app/janfrancisco19/cactus-app-db-module?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Krystian19/cactus-app-db-module&amp;utm_campaign=Badge_Grade) [![Test Coverage](https://codecov.io/gh/Krystian19/cactus-app-db-module/branch/master/graph/badge.svg)](https://codecov.io/gh/Krystian19/cactus-app-db-module)      | [![Build Status](https://travis-ci.org/Krystian19/cactus-app-js-logger-module.svg?branch=master)](https://travis-ci.org/Krystian19/cactus-app-js-logger-module) [![Codacy Badge](https://api.codacy.com/project/badge/Grade/a630bd46e14a42cba04dde7f7147e039)](https://www.codacy.com/app/janfrancisco19/cactus-app-js-logger-module?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Krystian19/cactus-app-js-logger-module&amp;utm_campaign=Badge_Grade) [![Test Coverage](https://codecov.io/gh/Krystian19/cactus-app-js-logger-module/branch/master/graph/badge.svg)](https://codecov.io/gh/Krystian19/cactus-app-js-logger-module)

|  [Video editing tool](https://github.com/Krystian19/cactus-app-video-editing-tool)
|:---------------------:|
| [![Codacy Badge](https://api.codacy.com/project/badge/Grade/ae6331fb07014972808b53125a820964)](https://www.codacy.com/app/janfrancisco19/cactus-app-video-editing-tool?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Krystian19/cactus-app-video-editing-tool&amp;utm_campaign=Badge_Grade)

## Screenshots
![Alt text](screenshots/capture1.png?raw=true "Anime Description view")

# Requirements

+ **Do you have Docker installed ?**
```sh
docker -v
  Docker version 18.03.0-ce # Or later
```

+ **Do you have git-lfs installed ?**
```sh
git-lfs --version
  git-lfs/2.5.2 (GitHub; darwin amd64; go 1.11) # Or later
```

# How to setup
Clone this project with all of it's modules recursively (it's a little heavy, so it'll take a bit):

```sh
git clone --recurse-submodules git@github.com:Krystian19/cactus-app.git
```

And start the project with:
```sh
docker-compose up -d
```

Then run the seeders to have some basic data ...
```sh
# Run the seeders
docker exec -ti cactus_admin /code/seeds.sh
```

And voilà, the web client should be running @ http://localhost:5000/

## Glossary of UI routes

- Web Client
    - Running @ http://localhost:5000

- GraphQL playground
    - Running @ http://localhost:4000

- Logger service UI
    - Running @ http://localhost:4040

- Content Admin panel
    - Running @ http://localhost:6500/admin

- PgAdmin Instance, User: "postgres", Password: "secret" (connect to cactus.postgres host)
    - Running @ http://localhost:5050

## Todos
+ - [ ] Take into account that with the new changes, Movies/Specials will appear on the Hottest/Newest Episodes section (in the title it should show that it is a movie or an special)
+ - [ ] Model field change, IMG filenames should be generated by the DB
+ - [x] The order of the Hottest Episodes section should be defined by the amount of views each episode has
+ - [x] Remove the video player controls in mobile (as the embedded mobile player is doing it by itself already)
+ - [ ] In the Anime Search view thumbnails show the name of the anime and the season, (Not the seasons's name)
+ - [ ] Make Release titles optional, if the Relaese title of a Season is not specified mark it as "title (Season 1)", if it's not a Season then just display the Anime name.
+ - [ ] Setup client support for movies, ovas and specials
    + - [ ] Setup client's Anime Details view to support Movies
+ - [ ] Setup Multi-language support for Episodes, Movies, and OVAs (Including Markup)
+ - [ ] Setup schedule view support for episodes that are out but not translated
+ - [ ] Setup schedule view support for delayed episodes
  + - [ ] Set time countdown for an episode in the anime info view (state delayed episodes)
  + - [ ] Episodes can be delayed for more than 2 weeks find a way of showing that.
+ - [ ] Setup session based security in the client service to provent access to the static files if the client is lacking the session value
+ - [ ] Limit the amount of categories that can be filtered (to 4) (Check for the compatibility in mobile, it breaks when there's a lot of them)
+ - [x] Improve client's support for mobile
  + - [x] Scrolling is painfully slow in IOS devices
+ - [ ] Setup Google Analytics support throughout the app
  + - [ ] Setup base Google Analytics snippet to check the amount of people in the app right now
  + - [ ] Setup base Google Analytics snippet to check the amount of people in an specific episode
    + - [ ] Setup DB support to save Google Analytics snippets to be rendered on every episode of any series.
+ - [ ] Remove the seq logger from the system and use prometheus and grafana to log and track the static content delivery (if images and video chunks are actually being delivered, that way we can tell when do we need to scale our services).









+ - [ ] Setup multi-language support for the app
  + - [ ] Setup a way of signaling that an episode is only available in a certain language
  + - [ ] Caption support for the video player, video server and backend admin
  + - [ ] Setup Category title support based in the language
+ - [ ] Setup Multi-language support for categories
    + - [ ] Setup Multi-language display for categories
        + - [ ] Setup Multi-language search for categories
+ - [ ] Implement HLS streaming for the video player view
  + - [x] Study how to implement HLS properly
  + - [x] Implment a proper HLS Video player
  + - [x] Implement a proper local HLS server for development
  + - [ ] Set video server to serve static subtitle files
+ - [ ] Setup the django admin to leverage massive anime content amounts
+ - [ ] Setup a way in the anime info view to connect with the next season
+ - [x] Setup db support for movies and ovas
+ - [ ] Setup support for episodes that are not available in the user's browser language
    + - [ ] Setup support for raw episodes and movies client-side
+ - [ ] Setup views tracking of the anime video view
+ - [ ] Setup SEO support for the whole application
  + - [ ] Setup SEO support for every anime episode detail view
+ - [ ] Add picture-in-picture functionality to the video player
+ - [ ] Define a proper pipeline that edits videos programmatically
  + - [x] Develop cli to interact with video editing pipeline
  + - [x] Apply steps of the process programmatically
  + - [ ] Setup cactus intro video sequence for edited videos
  + - [ ] Include subtitle time editing (modify subtitle appearance times)
  + - [ ] Setup proper cactus watermark
  + - [ ] Setup proper cactus intro sequence in the edited videos
+ - [ ] Implement a not found page for content that is not found
  + - [ ] Setup component to be used in such cases
+ - [ ] Create an error component to show if the client's requests fails
  + - [ ] Create a method of handling request failures that can be used universally between components.
+ - [ ] Add more series to the backend-admin's seeding script data
+ - [ ] Complete missing tests of backend admin's models
+ - [ ] Complete model tests for the db module
+ - [ ] Study how to convert the Frontend app in a Desktop native app
  + - [ ] Study how to distribute updates to said Desktop app

## License
MIT © [Jan Guzman](https://github.com/Krystian19)
